var LRTEditor={};
(function(){var a,e=this,c={};this.selection=this.element=null;this.initialize=function(b,m,f){this.element=b;a=f;m.forEach(function(b){window["LRTEditor_"+b].initialize(this)}.bind(this));this.element.addEventListener("keydown",function(b){d.apply(e,[b])});this.element.addEventListener("keyup",function(b){d.apply(e,[b])});this.element.addEventListener("input",function(b){d.apply(e,[b])});this.highlight();this.element.setAttribute("contentEditable","true")};var d=function(b){this.selection=this.getSelection();
try{this.dispatchEvent(b.type,[b])}catch(a){if(a!=this._stopPropagation)throw a;return}"input"==b.type&&this.reformat();this.setSelection(this.selection)};this.stripHtml=function(b){b||(b=this.element);b.textContent=b.textContent};this.highlight=function(){a(this.element);this.element.innerHTML='<span class="line">'+this.element.innerHTML.replace(/\n/g,'</span>\n<span class="line">')+"</span>"};this.reformat=function(){this.stripHtml();this.highlight()};var h=function(b,a){if(3==b.nodeType)a(b);else for(var f=
0,c=b.childNodes.length;f<c;++f)h(b.childNodes[f],a)};this.getSelection=function(){var b=0,a=0,f=0,c=!1,d={},e=function(e){c||e!=l.startContainer||(a=b+l.startOffset,c=!0);if(c&&e==l.endContainer)throw f=b+l.endOffset,d;b+=e.length},k=window.getSelection(),l=k.getRangeAt(0);if(k.rangeCount)try{h(this.element,e)}catch(g){if(g!=d)throw g;}return{start:a,end:f}};this.setSelection=function(b){var a=0,f=document.createRange(),c=!1,e={};f.collapse(this.element);var d=function(d){var g=a+d.length;!c&&b.start>=
a&&b.start<=g&&(f.setStart(d,b.start-a),c=!0);if(c&&b.end>=a&&b.end<=g)throw f.setEnd(d,b.end-a),e;a=g};try{h(this.element,d)}catch(k){if(k!=e)throw k;window.getSelection().removeAllRanges();window.getSelection().addRange(f)}};this.addEventListener=function(b,a){c.hasOwnProperty(b)||(c[b]=[]);c[b].push(a)};this.removeEventListener=function(b,a){if(!c.hasOwnProperty(b))return!1;var f=c[b].indexOf(a);-1!=f&&delete c[b][f]};this.dispatchEvent=function(a,d){if(!c.hasOwnProperty(a))return!1;d=d||[];for(var f=
0,e=c[a].length;f<e;f++)c[a][f].apply(null,d)}}).apply(LRTEditor);var LRTEditor_MinimalPlugin={};
(function(){var a=null;this.initialize=function(c){a=c;a.addEventListener("keydown",function(a){e.apply(this,[a])})};var e=function(c){var d=window.getSelection().getRangeAt(0);if(9!=c.keyCode||c.shiftKey||c.altKey)if(13==c.keyCode)d.deleteContents(),d.insertNode(document.createTextNode("\n")),a.selection.start+=2,a.selection.end=a.selection.start;else return;else{if(a.selection.start!=a.selection.end)return c.preventDefault();d.insertNode(document.createTextNode("\t"));a.selection.start++;a.selection.end++}a.reformat();
c.preventDefault()}}).apply(LRTEditor_MinimalPlugin);var LRTEditor_UndoPlugin={};
(function(){var a,e=null,c,d=[];this.initialize=function(c){a=c;a.addEventListener("keyup",function(a){m.apply(this,[a])});a.addEventListener("keydown",function(a){h.apply(this,[a])});a.addEventListener("input",function(a){b.apply(this,[a])})};var h=function(b){0==d.length&&(a.stripHtml(),d.push({html:a.element.innerHTML,selection:a.selection}),a.highlight());c=b.ctrlKey&&(90==b.keyCode||89==b.keyCode)},b=function(b){if(c)c=!1;else{if(e){for(;e<d.length-1;)d.pop();e=null}a.stripHtml();d.push({html:a.element.innerHTML,
selection:a.selection});30<d.length&&d.shift()}},m=function(b){if(b.ctrlKey&&90==b.keyCode){if(null==e&&(e=d.length-1),e--,0>e)return}else if(b.ctrlKey&&89==b.keyCode&&null!=e){if(e++,e>d.length-1){e--;return}}else return;a.element.innerHTML=d[e].html;a.selection=d[e].selection;a.highlight()}}).apply(LRTEditor_UndoPlugin);