var LRTEditor={};
(function(){var b,c=this,e={};this.selection=this.element=null;this.stopPropagation={};this.config={addLineWrapper:!0};this.initialize=function(a,g,f){this.element=a;b=f;g.forEach(function(a){window["LRTEditor_"+a].initialize(this)}.bind(this));this.element.addEventListener("keydown",function(a){d.apply(c,[a])});this.element.addEventListener("keyup",function(a){d.apply(c,[a])});this.element.addEventListener("input",function(a){d.apply(c,[a])});this.highlight();this.element.setAttribute("contentEditable","true");
this.element.setAttribute("spellcheck","false")};var d=function(a){this.selection=this.getSelection();try{this.dispatchEvent(a.type,[a])}catch(g){if(g!=this.stopPropagation)throw g;return}"input"==a.type&&this.reformat();this.setSelection(this.selection)};this.stripHtml=function(a){a||(a=this.element);a.textContent=a.textContent};this.highlight=function(){b(this.element);this.config.addLineWrapper&&(this.element.innerHTML='<div><span class="line">'+this.element.innerHTML.replace(/\n/g,'</span>\n<span class="line">')+
"</span></div>")};this.reformat=function(){this.stripHtml();this.highlight()};var k=function(a,g){if(3==a.nodeType)g(a);else for(var f=0,b=a.childNodes.length;f<b;++f)k(a.childNodes[f],g)};this.getSelection=function(){var a=0,g=0,f=0,b=!1,e={},d=function(c){b||c!=l.startContainer||(g=a+l.startOffset,b=!0);if(b&&c==l.endContainer)throw f=a+l.endOffset,e;a+=c.length},c=window.getSelection(),l=c.getRangeAt(0);if(c.rangeCount)try{k(this.element,d)}catch(h){if(h!=e)throw h;}return{start:g,end:f}};this.setSelection=
function(a){var b=0,f=document.createRange(),c=!1,e={};f.collapse(this.element);var d=function(d){var h=b+d.length;!c&&a.start>=b&&a.start<=h&&(f.setStart(d,a.start-b),c=!0);if(c&&a.end>=b&&a.end<=h)throw f.setEnd(d,a.end-b),e;b=h};try{k(this.element,d)}catch(m){if(m!=e)throw m;window.getSelection().removeAllRanges();window.getSelection().addRange(f)}};this.addEventListener=function(a,b){e.hasOwnProperty(a)||(e[a]=[]);e[a].push(b)};this.removeEventListener=function(a,b){if(!e.hasOwnProperty(a))return!1;
var f=e[a].indexOf(b);-1!=f&&delete e[a][f]};this.dispatchEvent=function(a,b){if(!e.hasOwnProperty(a))return!1;b=b||[];for(var f=0,c=e[a].length;f<c;f++)e[a][f].apply(null,b)}}).apply(LRTEditor);var LRTEditor_MinimalPlugin={};
(function(){var b=null;this.initialize=function(e){b=e;b.addEventListener("keydown",function(b){c.apply(this,[b])})};var c=function(c){var d=window.getSelection().getRangeAt(0);if(9!=c.keyCode||c.altKey)if(13==c.keyCode)d.deleteContents(),d.insertNode(document.createTextNode("\n\u200b"));else return;else{if(b.selection.start!=b.selection.end||c.shiftKey){c.preventDefault();return}d.insertNode(document.createTextNode("\t"))}b.selection.start++;b.selection.end++;b.reformat();c.preventDefault()}}).apply(LRTEditor_MinimalPlugin);var LRTEditor_UndoPlugin={};
(function(){var b,c=null,e,d=[];this.initialize=function(c){b=c;d.push({html:b.element.innerHTML,selection:{start:0,end:0}});b.addEventListener("keyup",function(a){g.apply(this,[a])});b.addEventListener("keydown",function(a){k.apply(this,[a])});b.addEventListener("input",function(b){a.apply(this,[b])})};var k=function(a){e=a.ctrlKey&&(90==a.keyCode||89==a.keyCode)},a=function(a){if(e)e=!1;else{if(c){for(;c<d.length-1;)d.pop();c=null}b.stripHtml();d.push({html:b.element.innerHTML,selection:b.selection});
30<d.length&&d.shift()}},g=function(a){if(a.ctrlKey&&90==a.keyCode){if(null==c&&(c=d.length-1),c--,0>c)return}else if(a.ctrlKey&&89==a.keyCode&&null!=c){if(c++,c>d.length-1){c--;return}}else return;b.element.innerHTML=d[c].html;b.selection=d[c].selection;b.highlight()}}).apply(LRTEditor_UndoPlugin);window.addEventListener("load",function(){LRTEditor.initialize(document.getElementsByTagName("code")[0],["MinimalPlugin","UndoPlugin"],function(b){sh_highlightElement(b,sh_languages.php)})});